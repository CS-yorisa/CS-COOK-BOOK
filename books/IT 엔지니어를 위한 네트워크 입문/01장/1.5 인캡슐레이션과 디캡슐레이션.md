# 1.5 인캡슐레이션과 디캡슐레이션
- 상위 계층에서 하위 계층으로 데이터를 보내면 물리 계층에서 전기 신호 형태로 네트워크를 통해 신호를 보냄
	- 인캡슐레이션 : 데이터를 보내는 과정
	- 디캡슐레이션 : 데이터를 받는 과정

![인캡슐레이션, 디캡슐레이션](https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Foopy.lazyrockets.com%2Fapi%2Fv2%2Fnotion%2Fimage%3Fsrc%3Dhttps%3A%252F%252Fs3-us-west-2.amazonaws.com%252Fsecure.notion-static.com%252F3bcb94f2-d85b-47c2-a3d7-2724f22d6718%252FUntitled.png%26blockId%3De1f8aecd-c4a7-4315-abc1-4241f5a6efce&f=1&nofb=1)

- 현대 네트워크는 대부분 패킷 기반 네트워크
	- 패킷이라는 작은 데이터로 데이터를 쪼개 보냄
	- 하나의 통신이 회선 전체를 점유하지 않고 동시에 여러 단말이 통신하도록 해줌
	- 데이터를 쪼개어 목적지로 보내고, 받는 쪽에서 다시 큰 데이터로 결합해 사용

## 인캡슐레이션
- 애플리케이션에서 데이터를 하위계층(L1 ~ L4)로 내려보내면서 패킷에 데이터를 넣을 수 있도록 분할하는 과정
- 데이터를 적절한 크기로 쪼개고, 4계층부터 네트워크 전송을 위한 헤더를 추가

## 디캡슐레이션
- 받는 쪽에서 인캡슐레이션 반대 과정 수행
- 전기신호를 2계층, 3계층, 4계층으로 올려보내는 과정
  
## 인캡슐레이션 과정
- 인캡슐레이션 과정에서 많은 헤더가 포함되고, 프로토콜마다 특성도 모두 다름
	- 하지만, 두가지 정보는 포함됨
		- 현재 계층에서 정의하는 정보
		- 상위 프로토콜 지시자
- 현재 계층에서 정의하고자 하는 정보는, 각 계층의 목적에 맞는 정보 포함
	- 4계층 : 큰 데이터를 잘 분해해서 보내고, 잘 조립하는 것
		- 패킷의 순서가 맞는지, 빠진 패킷은 없는지 점검하는 역할
		- 시퀀스(Sequence), ACK 번호 필드 등을 가짐
	- 3계층 : 논리적인 주소인 출발지, 도착지 IP주소를 헤더에 추가
	- 2계층 : 물리적인 주소인 출발지, 도착지 MAC주소를 헤더에 추가
- 프로토콜 스택은 상위 계층으로 올라갈수록 종류가 많아짐
	- 3계층 IP프로토콜은 4계층 TCP, UDP로 나뉘고, 상위 계층에서 FTP, HTTP, SMTP, POP3 등으로 나뉘어짐
	- 인캡슐레이션 과정에서 상위 프로토콜의 종류와 갯수는 상관없지만, 디캡슐레이션 할때 상위 프로토콜 정보 필요
		- 3계층에서 IP주로를 확인, 4계층에서 TCP, UDP중 어디로 보내야할 지 모름
	- 각 계층마다 프로토콜 지시자를 가지지만 이름이 다름
		- 4계층 포트 번호, 3계층 프로토콜 번호, 2계층 이더 타입

## MSS, MTU
- MSS(Maximum Segment Size)
	- 4계층에서 가질 수 있는 최대 데이터 값
	- 네트워크에서 수용할 수 있는 크기를 역산정해 4계층으로 내려올 때 적절한 크기로 쪼개질 수 있도록 유도
- MTU(Maximum Transmission Unit)
	- 네트워크에서 한 번에 보낼 수 있는 데이터 크기, 일반적으로 1500바이트
	- IP헤더, TCP헤더 크기가 각각 20바이트이브로 일반 이더넷의 경우 MSS를 1460으로 사용
