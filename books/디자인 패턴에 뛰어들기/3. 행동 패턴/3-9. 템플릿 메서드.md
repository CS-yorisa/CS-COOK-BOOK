# 템플릿 메서드 패턴
## 문제 상황
![](https://refactoring.guru/images/patterns/diagrams/template-method/problem.png)
- 회사 문서들을 분석하는 데이터 마이닝 앱을 제작 중
	- 어떤 앱은 doc 파일만, 어떤 앱은 csv 파일만, 또 어떤 앱은 pdf 파일만 작업 가능
	- 세 클래스에 유사한 코드가 많음을 알고, 데이터 처리 코드는 다르지만, 데이터 처리 및 분석 코드가 모두 유사할 때 중복을 제거해야 하는지 고민

## 해결 방법
- 템플릿 메서드 패턴은 알고리즘을 일련의 단계로 나누고, 단계를 메서드들로 변환한 뒤 단일 탬플릿 메서드 내부에 메서드들에 대한 일련의 호출들을 넣으라고 제안
	- 이러한 단계들은 추상이거나 디폴트 구현을 가짐
	- 알고리즘을 사용하기 위해 자식 클래스를 제공, 모든 추상 단계 구현, 필요하다면 일부 단계 오버라이드
![](https://refactoring.guru/images/patterns/diagrams/template-method/solution-ko.png)
- 처음에는 모든 단계를 추상으로 선언, 메서드에 대한 자체 구현을 강제하도록 할 수 있음
- 중복 코드 제거
	- 파일 열기/닫기, 데이터 추출/파싱을 위한 코드 : 데이터 형식에 따라 다르므로 건드릴 의미가 없음
	- 미가공 데이터 분석, 보고서 작성 등은 매우 유사하므로 기초 클래스로 끌어올릴 수 있음
- 두 가지 유형의 단계
	- 모든 자식 클래스는 추상 단계들을 구현
	- 선택적 단계들에 이미 어떤 디폴트 구현이 있지만, 이를 무시하고 오버라이드 가능

## 패턴 구조
![](https://refactoring.guru/images/patterns/diagrams/template-method/structure.png)
- 추상 클래스 : 알고리즘 단계들의 역할을 하는 메서드 선언, 메서드를 특정 순서로 호출하는 템플릿 메서드도 선언
- 구상 클래스 : 모든 단계들을 오버라이드할 수 있지만, 템플릿 메서드 자체는 오버라이드 할 수 없음

## 패턴 적용
- 클라이언트들이 알고리즘의 특정 단계만 확장할 수 있도록 하고 싶을 때, 그러나 전체 알고리즘이나, 알고리즘 구조는 확장하지 못하도록 할 때 사용
- 약간의 차이가 있지만 거의 같은 알고리즘들을 포함하는 여러 클래스가 있는 경우에 사용, 알고리즘이 변경되면 모든 것을 수정해야 할 수도 있음

## 장단점
- ✅
	- 클라이언트들이 대규모 알고리즘의 특정 부분만 오버라이드하도록 하여 그들이 알고리즘의 다른 부분에 영향을 덜 받도록 할 수 있음
	- 중복 코드를 부모 클래스로 가져올 수 있음
- ❌
	- 일부 클라이언트들은 제공된 골격에 의해 제한될 수 있음
	- 자식 클래스를 통해 디폴트 단계 구현을 억제하여 리스코프 치환 원칙을 위반할 수 있음
	- 템플릿 메서드들은 단계들이 더 많을수록 유지가 어려운 경향이 있음

## 다른 패턴과의 관계
- [[1-1. 팩토리 메서드]]는 **템플릿 메서드**의 특수화라고 생각할 수 있고, 동시에 **템플릿 메서드**의 단계의 역할을 **팩토리 메서드**가 할 수 있음
- **템플릿 메서드**는 상속을 기반으로, [[3-8. 전략]]은 합성을 기반으로
	- **템플릿 메서드**는 클래스 수준에서 작동하여 정적
	- **전략**은 객체 수준에서 작동하여 런타임에 행동들을 전환할 수 있도록 함
