# 옵서버 패턴
## 문제 상황
![](https://refactoring.guru/images/patterns/content/observer/observer-comic-1-ko.png?id=57406189c12563bb80b8e54042948298)
- `손님` 및 `가게`라는 두 가지 유형의 객체가 있고, 손님은 매장에 출시될 특정 브랜드 제품에 관심 있음
	- 손님 입장 : 손님은 매일 매장을 방문하여 재고 확인을 할 수 있으나, 제품 운송중에는 대부분의 방문이 무의미함
	- 가게 입장 : 제품이 출시될 때마다 고객에게 "스팸"으로 간주될 수 있는 이메일을 보낼 수 있음
- 손님이 시간을 낭비하던가, 가게가 자원을 낭비해야 함

## 해결 방법
- 시간이 지나면 변경될 수 있는 상태를 가진 객체, 일반적으로 **주제(subject)** 라고 불림
![](https://refactoring.guru/images/patterns/diagrams/observer/solution1-ko.png?id=5df3ff2a5b9f8660433b0a7a8685287e)
- 옵서버 패턴은 개별 객체들이 이벤트들의 알림들을 구독 또는 취소하는 알고리즘 추가
	- 구독자 객체들에 대해 참조의 리스트를 저장하기 위해 배열 필드와
	- 그 리스트에 구독자들을 추가하거나 제거할 수 있도록 하는 여러 공개된 메서드들로 구성
![](https://refactoring.guru/images/patterns/diagrams/observer/solution2-ko.png?id=c91ea0905f2ea3ebdce959d975b19ab8)
- 앱에서 여러 유형의 publisher(출판사)가 있고, 구독자들과 호환되도록 하려면 모든 출판사가 같은 인터페이스를 따르도록 할 수 있음

## 패턴 구조
![](https://refactoring.guru/images/patterns/diagrams/observer/structure.png?id=365b7e2b8fbecc8948f34b9f8f16f33c)
- 출판사
- 구독자
- 구상 구독자
- 클라이언트

## 패턴 적용
- 한 객체의 상태가 변경되어 다른 객체들을 변경해야 할 필요성이 생겼을 때, 실제 객체 집합들을 미리 알 수 없거나 이러한 집합들이 동적으로 변경될 때 사용
	- GUI 클래스와 작업할 때 자주 경험할 수 있음, 버튼 클래스들을 생성했고, 사용자가 버튼을 누를 때마다 코드가 실행되도록 하고 싶다고 가정
	- 옵서버 패턴은 구독자 인터페이스를 구현하는 모든 객체가 출판사 객체의 이벤트 알림에 구독할 수 있도록 함
- 앱의 일부 객체들이 제한된 시간 동안 또는 특정 경우에만 다른 객체들을 관찰해야할 때 사용
	- 구독 리스트는 동적이므로 구독자들은 필요할 때마다 리스트에 가입, 탈퇴할 수 있음

## 장단점
- ✅
	- 개방/폐쇄 원칙 : 출판사의 코드를 변경하지 않고도 새 구독자 클래스들을 도입할 수 잇음
	- 런타임에 객체 간의 관계 형성할 수 있음
- ❌
	- 구독자들은 무작위로 알림을 받음

## 다른 패턴과의 관계
- [[3-2. 커맨드 패턴]], [[3-4. 중재자]], **옵서버**, [[3-1. 책임 연쇄]] : 요청의 발신자와 수신자를 연결하는 다양한 방법을 다룸
	- **책임 연쇄** : 잠재적 수신자의 동적 체인을 따라 수신자 중 하나에 의해 요청이 처리될 때까지 요청을 순차적 전달
	- **커맨드** : 발신자와 수신자 간의 단방향 연결 설립
	- **중재자** : 발신자와 수신자 간의 직접 연결을 제거하여 중재자 객체를 통해 간접적으로 통신하도록 강제함
	- **옵서버** : 수신자들이 요청들의 수신을 동적으로 구독 및 취소할 수 있음
- **중재자**, **옵서버** : 이 둘의 차이는 종종 애매함, 대부분의 경우 두 패턴 중 하나를 구현할 수 있으나, 두 패턴을 동시에 적용 가능
	- **중재자** : 주목적은 시스템 콤포넌트들의 집합 간의 상호 의존성 제거, 컴포넌트들은 단일 중재자 객체에 의존하게 됨
	- **옵서버** : 객체들 사이의 단방향 연결을 설정, 일부 객체는 다른 객체의 종속자 역할을 함
	- **옵서버**에 의존하는 **중재자**패턴의 인기있는 구현이 있음
