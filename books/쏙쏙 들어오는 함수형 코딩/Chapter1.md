# CH1함수형 코딩 시작

## 함수형 프로그래밍이란?

### 함수형 프로그래밍(functional programming)

- 수학 함수를 사용하고 부수 효과(side effect)를 피하는 것이 특징인 프로그래밍 패러다임
- 부수 효과 없이 순수 함수(pure function)만 사용하는 프로그래밍 스타일



### 부수 효과

- 함수가 리턴값 외에 하는 모든 일
  - 메일 보내기, 전역 상태 수정하기, 파일 읽기, 웹 요청 하기 등
- 요청 시 마다 발생하므로, 리턴 값이 필요해서 불렀지만 의도치 않은 부수 효과 발생 가능
- 대부분의 함수형 프로그래밍은 불필요한 부수 효과의 사용 지양



### 순수 함수

- 인자에만 의존하고 부수 효과가 없는 함수
  - 같은 인자를 넣으면 항상 같은 결과를 돌려줌
- 수학에서의 함수도 동일하므로 이를 '수학 함수'라고도 봄



### 실용 측면의 문제점

- 실제 함수형 프로그래밍은 부수 효과와 순수하지 않은 함수를 사용
- 실제 프로그래밍에서 부수 효과는 필요하고, 이로 인한 순수하지 않은 함수를 다루는 기술 존재
- 함수형 프로그래밍은 객체 지향, 절차적 프로그래밍 모두 가르지 않고 어디에서나 사용 가능



## 액션, 계산, 데이터 구분

- 함수형 프로그래머는 코드를 액션과 계산, 데이터로 구분

``` javascript
---- 액션

* sendEmail(to, from, subject, body)

* saveUserDB(user)

* getCurrentTime()

---- 계산

sum(numbers)

string_length(str)

---- 데이터

[1, 10, 2, 45, 3, 98]

{"firstName" : "Eric",
 "lastName" : "Normand"}

```

- **액션**은 언제, 얼만큼 호출하는지가 중요
- **계산**과 **데이터**는 부르는 시점이나 횟수가 중요하지 않고, **실행 여부**에 있음
  - 계산은 실행 가능하나, 데이터는 정적이고 보이는 그대로
  - 계산은 실행하기 전까지 어떻게 동작할 지 알 수 없음 
- 액션, 계산, 데이터를 적절히 사용. 결과적으로 가장 쓰기 좋은 것은 데이터.



### ☁️  클라우드 서비스 시나리오에서 구분 해보기

- 여러 클라이언트가 작업 완료 표시를 하면 서버에서 이메일을 통해 알려주는 서비스



#### 1. 사용자가 작업 완료 표시를 함

- UI 이벤트로 실행 횟수에 의존하기 때문에 액션

#### 2. 클라이언트가 서버로 메시지를 보냄

- 메시지를 보내는 것은 액션
- 메시지 자체는 서버에서 해석하는 값으로 데이터

#### 3. 서버가 메시지를 받음

- 메시지를 받는 것은 횟수에 의존하므로 액션

#### 4. 서버가 데이터베이스를 변경

- 내부 상태를 바꾸는 것은 액션

#### 5. 서버가 누구에게 알림을 보낼지 결정

- 결정하는 것은 계산
- 입력값이 같다면 서버는 항상 같은 결정을 내림

#### 6. 서버가 이메일로 알림을 보냄

- 결정된 내용을 전송하는 것은 액션
- 같은 메일을 한 번 보내는 것과 두 번 보내는 것은 다름



## 액션, 계산, 데이터 정의

### 액션

- 실행 시점이나 횟수 또는 둘 다에 의존
  - 시간이 지남에 따라 안전하게 상태를 바꿀 수 있는 방법
  - 순서를 보장하는 방법
  - 액션이 정확히 한 번만 실행되게 보장하는 방법

### 계산

- 입력값으로 출력값을 만드는 것
- 같은 입력값을 가지고 계산하면 항상 같은 결괏값이 나옴
- 언제, 어디에서 계산해도 결과는 같고 외부에 영향을 주지 않으며 몇 번을 불러도 안전함
  - 정확성을 위한 정적 분석
  - 소프트웨어에서 쓸 수 있는 수학적 지식
  - 테스트 전략

### 데이터

- 이벤트에 대해 기록한 사실
- 알아보기 쉬운 속성으로 되어 있고 실행하지 않아도 데이터 자체로 의미가 있음
- 같은 데이터를 여러 형태로 해석 할 수 있음
  - 효율적으로 접근하기 위해 데이터를 구성하는 방법
  - 데이터를 보관하기 위한 기술
  - 데이터를 이용해 중요한 것을 발견하는 원칙

### 구분 시 장점

- 분산 시스템에서 유용
  - 분산 시스템은 메시지 순서가 바뀌거나 메시지가 여러 번 혹은 아예 도착하지 않을 수도 있음
  - 또한 응답을 받지 못하면 무슨 일이 생겼는지 알 수 없음
- 시간에 따라 바뀌는 값을 모델링할 때 시점이나 횟수에 의존하는 액션을 찾아 리팩토링
  - 액션에서 시간에 의존하는 부분을 분리하면 좀 더 다루기 쉬워짐
  - 계산은 시간에 의존하지 않기 때문에 가능한 코드를 계산으로 바꾸는 것이 좋음